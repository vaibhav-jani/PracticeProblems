package x.y

fun main() {
    val arr = largeIntArray()
    val result = oddEvenJumps(arr)
    println("Result: $result")
}

fun oddEvenJumps(arr: IntArray): Int {

    val lastIndex = arr.size - 1
    var goodIndexeCount = 0
    val smallestIndexJumpMap = HashMap<Int, Int>()
    val largestIndexJumpMap = HashMap<Int, Int>()
    arr.forEachIndexed { index, number ->
        println("$index")
        println("-------------")
        var jumpCount = 1
        var nextIndex = index
        while (nextIndex >= 0) {
            if (nextIndex == lastIndex) {
                println("GOOD")
                ++goodIndexeCount
                break
            }
            // If odd jump
            if (jumpCount % 2 == 1) {
                val currentIndex = nextIndex
                nextIndex = if (smallestIndexJumpMap.contains(currentIndex)) {
                    smallestIndexJumpMap[currentIndex]!!
                } else {
                    smallestUpcomingGreaterThanEqualToIndex(arr, currentIndex)
                }
                smallestIndexJumpMap.put(currentIndex, nextIndex)
            } else { // If even jump
                val currentIndex = nextIndex
                nextIndex = if (largestIndexJumpMap.contains(currentIndex)) {
                    largestIndexJumpMap[currentIndex]!!
                } else {
                    largestUpcomingLessThanEqualToIndex(arr, nextIndex)
                }
                largestIndexJumpMap.put(currentIndex, nextIndex)
            }
            ++jumpCount
            if (nextIndex == lastIndex) {
                println("GOOD")
                ++goodIndexeCount
                break
            }
        }
        println("==============")
    }

    return goodIndexeCount
}

fun smallestUpcomingGreaterThanEqualToIndex(arr: IntArray, current: Int): Int {

    val start = current + 1
    val end = arr.size - 1
    var smallestIndex = -1
    for (index in start..end) {
        if (arr[index] >= arr[current]) {
            if ((smallestIndex == -1) || (arr[index] < arr[smallestIndex])) {
                smallestIndex = index
            }
        }
        println("arr[$index]: ${arr[index]}")
    }
    println("index: $current -> smallestIndex: $smallestIndex")
    return smallestIndex
}


fun largestUpcomingLessThanEqualToIndex(arr: IntArray, current: Int): Int {

    val start = current + 1
    val end = arr.size - 1
    var largestIndex = -1
    for (index in start..end) {
        if (arr[index] <= arr[current]) {
            if ((largestIndex == -1) || (arr[index] > arr[largestIndex])) {
                largestIndex = index
            }
        }
        println("arr[$index]: ${arr[index]}")
    }
    println("index: $current -> largestIndex: $largestIndex")
    return largestIndex
}


fun largeIntArray(): IntArray {
    return intArrayOf(
        93954,
        18500,
        17358,
        96576,
        36038,
        81177,
        901,
        99079,
        1649,
        60757,
        92845,
        83126,
        31040,
        82208,
        39304,
        49980,
        36327,
        35471,
        58207,
        78206,
        69949,
        76807,
        1427,
        53169,
        35278,
        20861,
        92085,
        19680,
        18447,
        17881,
        65809,
        61173,
        50563,
        58680,
        94057,
        86121,
        90593,
        5415,
        89741,
        3135,
        64764,
        93083,
        50246,
        41932,
        33174,
        91612,
        92596,
        61912,
        71442,
        33912,
        13817,
        97900,
        65702,
        27438,
        97708,
        60896,
        33058,
        89581,
        7790,
        80415,
        15957,
        10767,
        25894,
        71482,
        60800,
        42127,
        15904,
        92375,
        76628,
        68626,
        81290,
        77424,
        11242,
        77335,
        83872,
        74675,
        48227,
        68644,
        10000,
        76434,
        26222,
        78512,
        63528,
        50907,
        53601,
        7473,
        4089,
        1482,
        77554,
        13849,
        12286,
        38506,
        97770,
        88592,
        31328,
        81979,
        8507,
        39204,
        57920,
        98624,
        4870,
        41242,
        91961,
        2761,
        59908,
        39939,
        56026,
        70334,
        40669,
        89205,
        95571,
        98505,
        5477,
        83682,
        87837,
        14540,
        94142,
        12711,
        20731,
        95554,
        83078,
        57655,
        28780,
        25271,
        40313,
        899,
        63635,
        5155,
        77385,
        7016,
        1025,
        28465,
        77269,
        83263,
        50730,
        93829,
        11451,
        33221,
        74034,
        32331,
        14536,
        57836,
        6257,
        37301,
        25386,
        33181,
        48518,
        53570,
        8435,
        31552,
        38369,
        40330,
        48003,
        42587,
        7402,
        21932,
        64428,
        82876,
        51144,
        14818,
        7046,
        15589,
        38404,
        56520,
        66425,
        52435,
        56529,
        35223,
        66559,
        72686,
        40212,
        81491,
        74393,
        90474,
        46674,
        34522,
        77720,
        3759,
        38387,
        97719,
        34226,
        51232,
        24976,
        7694,
        11095,
        43521,
        61900,
        54574,
        51868,
        11165,
        4025,
        35869,
        94248,
        17981,
        26926,
        48314,
        91420,
        94697,
        130,
        64789,
        23615,
        65448,
        74284,
        88713,
        68341,
        84720,
        78447,
        16071,
        4369,
        73877,
        52591,
        99786,
        16489,
        38526,
        28778,
        87869,
        48369,
        91364,
        70719,
        99880,
        59977,
        97615,
        17340,
        44168,
        57839,
        97829,
        56787,
        86526,
        62850,
        51240,
        39144,
        36863,
        29521,
        21136,
        96257,
        53646,
        86586,
        88496,
        94229,
        23816,
        33772,
        63313,
        32205,
        14392,
        75985,
        55039,
        53652,
        71047,
        11474,
        92190,
        47982,
        69182,
        60032,
        60523,
        70991,
        8879,
        49673,
        21028,
        38968,
        51174,
        35394,
        40671,
        73086,
        4332,
        95659,
        60391,
        16355,
        55721,
        8093,
        50147,
        68863,
        41977,
        31418,
        67371,
        93528,
        87363,
        38536,
        86340,
        11503,
        5872,
        98318,
        76290,
        61498,
        55878,
        30887,
        89908,
        85275,
        48171,
        22038,
        67639,
        72618,
        99550,
        79037,
        9124,
        98994,
        85451,
        58252,
        33093,
        73292,
        59662,
        9576,
        56351,
        2019,
        78869,
        82358,
        73011,
        9147,
        58809,
        39139,
        12839,
        89209,
        94229,
        92228,
        53121,
        86442,
        19783,
        29548,
        90871,
        59037,
        22601,
        13009,
        22831,
        49600,
        30348,
        73442,
        27131,
        7843,
        89821,
        66383,
        97406,
        18199,
        87038,
        1719,
        53782,
        47974,
        12619,
        81511,
        27085,
        89843,
        69941,
        85236,
        86648,
        79178,
        73648,
        407,
        14343,
        20713,
        57748,
        337,
        12715,
        48496,
        4106,
        31874,
        21998,
        17440,
        31660,
        88121,
        23144,
        64915,
        73399,
        67528,
        18874,
        34980,
        27215,
        53864,
        96903,
        21787,
        55237,
        6547,
        37556,
        95417,
        90847,
        9520,
        85252,
        71570,
        91792,
        46081,
        42255,
        89615,
        53615,
        76136,
        17764,
        6843,
        44049,
        32705,
        51187,
        34432,
        86258,
        73560,
        38395,
        12586,
        70984,
        54108,
        15194,
        3478,
        61670,
        51624,
        57545,
        41586,
        46871,
        39142,
        8772,
        53530,
        12160,
        67348,
        74941,
        16792,
        20151,
        24071,
        59851,
        40649,
        88753,
        54796,
        52563,
        21849,
        9085,
        92470,
        9963,
        13022,
        19530,
        57682,
        63903,
        43163,
        39489,
        64102,
        26209,
        80045,
        64004,
        60286,
        2887,
        34537,
        76885,
        20590,
        64449,
        97471,
        44054,
        51794,
        21204,
        701,
        23660,
        47183,
        60427,
        83592,
        29001,
        32904,
        72064,
        66428,
        71452,
        87728,
        8868,
        12448,
        49634,
        61260,
        65407,
        23009,
        13609,
        92143,
        24007,
        1782,
        28291,
        51719,
        63335,
        73920,
        14558,
        50787,
        32019,
        72468,
        35949,
        81114,
        19161,
        99470,
        52143,
        42384,
        72565,
        37884,
        3547,
        44087,
        28779,
        66121,
        52671,
        83009,
        48927,
        15534,
        14860,
        57262,
        26487,
        21159,
        94178,
        13929,
        91607,
        53622,
        93690,
        83903,
        29887,
        47019,
        8528,
        36667,
        92672,
        10099,
        24563,
        4272,
        86082,
        68358,
        58934,
        46565,
        26004,
        58584,
        70271,
        79299,
        16247,
        62530,
        67882,
        58117,
        72775,
        51778,
        95464,
        65018,
        62804,
        1315,
        14354,
        60107,
        76691,
        14425,
        63682,
        15434,
        76320,
        82120,
        62061,
        6791,
        27943,
        26953,
        46783,
        78006,
        57831,
        99195,
        70824,
        14135,
        97912,
        5861,
        33285,
        63725,
        39048,
        2217,
        29648,
        24186,
        77614,
        59255,
        14399,
        87260,
        21299,
        31967,
        87472,
        76521,
        42083,
        51927,
        97916,
        71080,
        71572,
        65578,
        98823,
        92400,
        29823,
        44515,
        63568,
        23690,
        64728,
        90327,
        30627,
        36792,
        44993,
        38631,
        64332,
        5196,
        77673,
        28534,
        62200,
        42386,
        61128,
        56894,
        51755,
        16032,
        752,
        10697,
        38489,
        25709,
        48479,
        47083,
        51538,
        13270,
        49740,
        95048,
        17198,
        1554,
        33888,
        70849,
        86075,
        10926,
        3120,
        31013,
        62203,
        92040,
        33042,
        77936,
        12751,
        64097,
        24996,
        76117,
        91212,
        44140,
        68721,
        35403,
        84907,
        41013,
        58407,
        98645,
        55763,
        45283,
        9606,
        94962,
        52489,
        70079,
        65458,
        23744,
        63707,
        9662,
        5728,
        84091,
        60078,
        30137,
        52683,
        55790,
        67777,
        13,
        14444,
        9316,
        75308,
        45233,
        19839,
        37448,
        66945,
        46122,
        54585,
        93753,
        40032,
        10325,
        10713,
        72471,
        31246,
        11503,
        77818,
        88881,
        10235,
        61651,
        74048,
        24583,
        83666,
        68401,
        44456,
        16571,
        25783,
        82946,
        16780,
        70463,
        57094,
        56071,
        1633,
        12270,
        30980,
        63032,
        38143,
        25649,
        38384,
        46311,
        59458,
        55974,
        36801,
        42546,
        80623,
        58901,
        97048,
        60247,
        28329,
        51311,
        47290,
        85292,
        73749,
        88058,
        71782,
        25327,
        27281,
        16380,
        87904,
        90008,
        32356,
        2322,
        47426,
        78837,
        70295,
        67560,
        2101,
        10191,
        72921,
        81855,
        18221,
        81638,
        95128,
        60163,
        55172,
        3292,
        41394,
        46699,
        95345,
        44086,
        1191,
        56710,
        6812,
        99201,
        65969,
        71908,
        69348,
        94099,
        40494,
        27894,
        7871,
        2282,
        47717,
        74370,
        73924,
        287,
        61665,
        83178,
        86694,
        76962,
        41888,
        70395,
        70153,
        6420,
        3888,
        34613,
        64335,
        38096,
        64498,
        76151,
        77137,
        28318,
        97173,
        55379,
        62790,
        63520,
        67334,
        15400,
        67457,
        43153,
        96868,
        71415,
        97399,
        99106,
        83399,
        58619,
        60067,
        46968,
        36967,
        41874,
        91349,
        64630,
        16992,
        3726,
        43915,
        44086,
        6582,
        22675,
        33140,
        37673,
        62490,
        15599,
        82178,
        49711,
        6912,
        9958,
        94317,
        3198,
        64898,
        17898,
        65420,
        98759,
        91820,
        43725,
        43150,
        28943,
        44041,
        95792,
        3785,
        47883,
        89572,
        10661,
        11672,
        81477,
        28282,
        79793,
        30180,
        3230,
        81983,
        33181,
        46130,
        5985,
        65083,
        82895,
        21975,
        93320,
        63359,
        54819,
        20585,
        87606,
        42394,
        4266,
        92577,
        36884,
        29458,
        5800,
        3309,
        4310,
        87496,
        86788,
        46973,
        8124,
        13925,
        94752,
        56071,
        79559,
        7683,
        6531,
        77712,
        11580,
        82070,
        93444,
        43283,
        11513,
        71762,
        44568,
        50141,
        88798,
        53985,
        13819,
        37251,
        84966,
        51144,
        8074,
        50654,
        3509,
        87930,
        24811,
        72917,
        99464,
        89636,
        52862,
        32414,
        69874,
        54661,
        90880,
        24217,
        69345,
        15248,
        40509,
        77739,
        36434,
        28362,
        35290,
        37365,
        797,
        14312,
        74057,
        69278,
        65248,
        13685,
        11583,
        48955,
        48390,
        12579,
        96582,
        81734,
        87221,
        17219,
        65653,
        81323,
        32351,
        98534,
        9507,
        79322,
        14461,
        25131,
        18951,
        11573,
        67089,
        24295,
        79925,
        76944,
        95742,
        77469,
        99003,
        55732,
        3199,
        33200,
        39407,
        96631,
        42112,
        27017,
        79974,
        91978,
        4667,
        98097,
        72268,
        99575,
        64855,
        778,
        67832,
        22673,
        98846,
        93208,
        86075,
        70866,
        25339,
        92664,
        82261,
        63392,
        17095,
        19924,
        56691,
        59329,
        40801,
        81351,
        67837,
        25805,
        3004,
        60678,
        32939,
        88983,
        23420,
        54863,
        19792,
        96672,
        64293,
        75308,
        89085,
        45388,
        54674,
        44963,
        61907,
        33475,
        82196,
        36521,
        77138,
        1669,
        36368,
        47989,
        90105,
        72236,
        73380,
        63664,
        90074,
        72491,
        63147,
        92085,
        76419,
        1478,
        86861,
        18819,
        74837,
        41338,
        39230,
        15385,
        42886,
        99944,
        82729,
        73674,
        64293,
        21467,
        6316,
        93272,
        90854,
        221,
        91108,
        74886,
        9874,
        15422,
        17636,
        25660,
        90282,
        42117,
        53847,
        42434,
        46409,
        25080,
        31512,
        25244,
        28489,
        60792,
        2331,
        93728,
        51374,
        50212
    )
}